<div class="form-container">
  <button class="btn-close" (click)="cerrar()">
    <i class="fas fa-times"></i>
  </button>
  <h2>Registrar Préstamo</h2>
  <form #form="ngForm" (ngSubmit)="registrar()">
    
    <!-- Información del Usuario -->
    <div class="form-section">
      <h3>Información del Usuario</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="carnetUsuario">Carnet Usuario</label>
          <input 
            type="text" 
            id="carnetUsuario" 
            name="carnetUsuario" 
            [(ngModel)]="prestamo.CarnetUsuario"
            required
            placeholder="Carnet del usuario"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="telefonoUsuario">Teléfono</label>
          <input 
            type="tel" 
            id="telefonoUsuario" 
            name="telefonoUsuario" 
            [(ngModel)]="prestamo.TelefonoUsuario"
            placeholder="Teléfono del usuario"
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="nombreUsuario">Nombre</label>
          <input 
            type="text" 
            id="nombreUsuario" 
            name="nombreUsuario" 
            [(ngModel)]="prestamo.NombreUsuario"
            required
            placeholder="Nombre del usuario"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="apellidoPaternoUsuario">Apellido Paterno</label>
          <input 
            type="text" 
            id="apellidoPaternoUsuario" 
            name="apellidoPaternoUsuario" 
            [(ngModel)]="prestamo.ApellidoPaternoUsuario"
            placeholder="Apellido paterno"
            class="form-input"
          />
        </div>
      </div>
    </div>

    <!-- Información del Equipo -->
    <div class="form-section">
      <h3>Información del Equipo</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="nombreGrupoEquipo">Grupo Equipo</label>
          <input 
            type="text" 
            id="nombreGrupoEquipo" 
            name="nombreGrupoEquipo" 
            [(ngModel)]="prestamo.NombreGrupoEquipo"
            required
            placeholder="Nombre del grupo de equipo"
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="codigoImt">Código IMT</label>
          <input 
            type="text" 
            id="codigoImt" 
            name="codigoImt" 
            [(ngModel)]="prestamo.CodigoImt"
            required
            placeholder="Código IMT del equipo"
            class="form-input"
          />
        </div>
      </div>
    </div>

    <!-- Fechas del Préstamo -->
    <div class="form-section">
      <h3>Fechas del Préstamo</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="fechaSolicitud">Fecha Solicitud</label>
          <div class="input-with-button">
            <input 
              type="datetime-local" 
              id="fechaSolicitud" 
              name="fechaSolicitud" 
              [value]="formatearFechaParaInput(prestamo.FechaSolicitud)"
              (change)="onFechaChange($event, 'FechaSolicitud')"
              class="form-input"
            />
            <button type="button" class="btn-now" (click)="establecerFechaActual()" title="Establecer fecha actual">
              <i class="fas fa-clock"></i>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="fechaPrestamoEsperada">Fecha Préstamo Esperada</label>
          <input 
            type="datetime-local" 
            id="fechaPrestamoEsperada" 
            name="fechaPrestamoEsperada" 
            [value]="formatearFechaParaInput(prestamo.FechaPrestamoEsperada)"
            (change)="onFechaChange($event, 'FechaPrestamoEsperada')"
            required
            class="form-input"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="fechaDevolucionEsperada">Fecha Devolución Esperada</label>
          <input 
            type="datetime-local" 
            id="fechaDevolucionEsperada" 
            name="fechaDevolucionEsperada" 
            [value]="formatearFechaParaInput(prestamo.FechaDevolucionEsperada)"
            (change)="onFechaChange($event, 'FechaDevolucionEsperada')"
            required
            class="form-input"
          />
        </div>

        <div class="form-group">
          <label for="estadoPrestamo">Estado del Préstamo</label>
          <select 
            id="estadoPrestamo" 
            name="estadoPrestamo" 
            [(ngModel)]="prestamo.EstadoPrestamo"
            required
            class="form-input"
          >
            <option value="Pendiente">Pendiente</option>
            <option value="Aprobado">Aprobado</option>
            <option value="Activo">Activo</option>
            <option value="Finalizado">Finalizado</option>
            <option value="Rechazado">Rechazado</option>
            <option value="Cancelado">Cancelado</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Observaciones -->
    <div class="form-section">
      <div class="form-group">
        <label for="observacion">Observaciones</label>
        <textarea 
          id="observacion" 
          name="observacion" 
          [(ngModel)]="prestamo.Observacion"
          rows="4"
          placeholder="Observaciones adicionales sobre el préstamo"
          class="form-input"
        ></textarea>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="cerrar()">Cancelar</button>
      <button type="submit" class="btn-submit" [disabled]="!form.valid">Registrar Préstamo</button>
    </div>
  </form>
</div>
